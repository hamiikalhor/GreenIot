; PlatformIO Project Configuration File
; GreenIoT Vertical Farming - Basil Environmental Monitoring Node
;
; Hardware: ESP32-C3
; Framework: ESP-IDF
; Language: C++17 with modern features
;
; Architecture (Firmware_Requirements.md compliant):
;   Core         -> Entry point (main.cpp)
;   Application  -> StateMachine, business logic
;   Services     -> PowerManager, data handling
;   HAL          -> ISensor interface, concrete sensors
;   Drivers      -> I2CDriver, peripheral control
;   Hardware     -> ESP-IDF APIs

[env:esp32-c3-devkitm-1]
platform = espressif32@6.5.0
board = esp32-c3-devkitm-1
framework = espidf

; Monitor configuration
monitor_speed = 115200
monitor_filters = 
    esp32_exception_decoder
    time

; Upload configuration
upload_speed = 921600

; Build flags
build_flags = 
    -DLOG_LOCAL_LEVEL=ESP_LOG_DEBUG
    -Wall
    -Wextra
    -Wno-unused-parameter

; Dependencies
lib_deps = 

; Board configuration
board_build.partitions = partitions.csv
board_build.flash_mode = dio
board_build.f_flash = 40000000L
board_build.f_cpu = 160000000L

; ESP-IDF specific - all sources are defined in main/CMakeLists.txt
board_build.cmake_extra_args = 
    -DCMAKE_CXX_STANDARD=17

; === Unit Testing Configuration (Native) ===
[env:native]
platform = native
build_flags = 
    -DNATIVE_BUILD
    -std=gnu++17
    -Wall
    -Wextra
    -Wno-unused-parameter
    -I src/HAL/Sensor/Inc
    -I src/HAL/Wireless/Inc
    -I src/Drivers/Inc
    -I src/Services/Inc
    -I src/Application/Inc
    -I src/Core/Inc
lib_deps = 
    throwtheswitch/Unity@^2.5.2
test_framework = unity
test_filter = test_*
test_build_project_src = true
build_src_filter = 
    +<src/HAL/Sensor/Src/*.cpp>
    +<src/Drivers/Src/*.cpp>
    -<src/Core/Src/main.cpp>
    -<src/Application/>
    -<src/Services/>
    -<src/HAL/Wireless/>
